e8dbf52f2a5eb09f1b2cc15d09a76868
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@angular/core/testing");
const testing_2 = require("@angular/common/http/testing");
const dayjs = require("dayjs");
const input_constants_1 = require("app/config/input.constants");
const plan_model_1 = require("app/entities/enumerations/plan.model");
const booking_model_1 = require("../booking.model");
const booking_service_1 = require("./booking.service");
describe('Service Tests', () => {
    describe('Booking Service', () => {
        let service;
        let httpMock;
        let elemDefault;
        let expectedResult;
        let currentDate;
        beforeEach(() => {
            testing_1.TestBed.configureTestingModule({
                imports: [testing_2.HttpClientTestingModule],
            });
            expectedResult = null;
            service = testing_1.TestBed.inject(booking_service_1.BookingService);
            httpMock = testing_1.TestBed.inject(testing_2.HttpTestingController);
            currentDate = dayjs();
            elemDefault = {
                id: 0,
                eventDate: currentDate,
                venue: 'AAAAAAA',
                plan: plan_model_1.Plan.BRONZE,
                createdDate: currentDate,
                contactNumber: 'AAAAAAA',
                emailId: 'AAAAAAA',
                userName: 'AAAAAAA',
                userId: 'AAAAAAA',
            };
        });
        describe('Service methods', () => {
            it('should find an element', () => {
                const returnedFromService = Object.assign({
                    eventDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                    createdDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                }, elemDefault);
                service.find(123).subscribe(resp => (expectedResult = resp.body));
                const req = httpMock.expectOne({ method: 'GET' });
                req.flush(returnedFromService);
                expect(expectedResult).toMatchObject(elemDefault);
            });
            it('should create a Booking', () => {
                const returnedFromService = Object.assign({
                    id: 0,
                    eventDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                    createdDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                }, elemDefault);
                const expected = Object.assign({
                    eventDate: currentDate,
                    createdDate: currentDate,
                }, returnedFromService);
                service.create(new booking_model_1.Booking()).subscribe(resp => (expectedResult = resp.body));
                const req = httpMock.expectOne({ method: 'POST' });
                req.flush(returnedFromService);
                expect(expectedResult).toMatchObject(expected);
            });
            it('should update a Booking', () => {
                const returnedFromService = Object.assign({
                    id: 1,
                    eventDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                    venue: 'BBBBBB',
                    plan: 'BBBBBB',
                    createdDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                    contactNumber: 'BBBBBB',
                    emailId: 'BBBBBB',
                    userName: 'BBBBBB',
                    userId: 'BBBBBB',
                }, elemDefault);
                const expected = Object.assign({
                    eventDate: currentDate,
                    createdDate: currentDate,
                }, returnedFromService);
                service.update(expected).subscribe(resp => (expectedResult = resp.body));
                const req = httpMock.expectOne({ method: 'PUT' });
                req.flush(returnedFromService);
                expect(expectedResult).toMatchObject(expected);
            });
            it('should partial update a Booking', () => {
                const patchObject = Object.assign({
                    contactNumber: 'BBBBBB',
                    userId: 'BBBBBB',
                }, new booking_model_1.Booking());
                const returnedFromService = Object.assign(patchObject, elemDefault);
                const expected = Object.assign({
                    eventDate: currentDate,
                    createdDate: currentDate,
                }, returnedFromService);
                service.partialUpdate(patchObject).subscribe(resp => (expectedResult = resp.body));
                const req = httpMock.expectOne({ method: 'PATCH' });
                req.flush(returnedFromService);
                expect(expectedResult).toMatchObject(expected);
            });
            it('should return a list of Booking', () => {
                const returnedFromService = Object.assign({
                    id: 1,
                    eventDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                    venue: 'BBBBBB',
                    plan: 'BBBBBB',
                    createdDate: currentDate.format(input_constants_1.DATE_TIME_FORMAT),
                    contactNumber: 'BBBBBB',
                    emailId: 'BBBBBB',
                    userName: 'BBBBBB',
                    userId: 'BBBBBB',
                }, elemDefault);
                const expected = Object.assign({
                    eventDate: currentDate,
                    createdDate: currentDate,
                }, returnedFromService);
                service.query().subscribe(resp => (expectedResult = resp.body));
                const req = httpMock.expectOne({ method: 'GET' });
                req.flush([returnedFromService]);
                httpMock.verify();
                expect(expectedResult).toContainEqual(expected);
            });
            it('should delete a Booking', () => {
                service.delete(123).subscribe(resp => (expectedResult = resp.ok));
                const req = httpMock.expectOne({ method: 'DELETE' });
                req.flush({ status: 200 });
                expect(expectedResult);
            });
            describe('addBookingToCollectionIfMissing', () => {
                it('should add a Booking to an empty array', () => {
                    const booking = { id: 123 };
                    expectedResult = service.addBookingToCollectionIfMissing([], booking);
                    expect(expectedResult).toHaveLength(1);
                    expect(expectedResult).toContain(booking);
                });
                it('should not add a Booking to an array that contains it', () => {
                    const booking = { id: 123 };
                    const bookingCollection = [
                        Object.assign({}, booking),
                        { id: 456 },
                    ];
                    expectedResult = service.addBookingToCollectionIfMissing(bookingCollection, booking);
                    expect(expectedResult).toHaveLength(2);
                });
                it("should add a Booking to an array that doesn't contain it", () => {
                    const booking = { id: 123 };
                    const bookingCollection = [{ id: 456 }];
                    expectedResult = service.addBookingToCollectionIfMissing(bookingCollection, booking);
                    expect(expectedResult).toHaveLength(2);
                    expect(expectedResult).toContain(booking);
                });
                it('should add only unique Booking to an array', () => {
                    const bookingArray = [{ id: 123 }, { id: 456 }, { id: 52973 }];
                    const bookingCollection = [{ id: 123 }];
                    expectedResult = service.addBookingToCollectionIfMissing(bookingCollection, ...bookingArray);
                    expect(expectedResult).toHaveLength(3);
                });
                it('should accept varargs', () => {
                    const booking = { id: 123 };
                    const booking2 = { id: 456 };
                    expectedResult = service.addBookingToCollectionIfMissing([], booking, booking2);
                    expect(expectedResult).toHaveLength(2);
                    expect(expectedResult).toContain(booking);
                    expect(expectedResult).toContain(booking2);
                });
                it('should accept null and undefined values', () => {
                    const booking = { id: 123 };
                    expectedResult = service.addBookingToCollectionIfMissing([], null, booking, undefined);
                    expect(expectedResult).toHaveLength(1);
                    expect(expectedResult).toContain(booking);
                });
                it('should return initial array if no Booking is added', () => {
                    const bookingCollection = [{ id: 123 }];
                    expectedResult = service.addBookingToCollectionIfMissing(bookingCollection, undefined, null);
                    expect(expectedResult).toEqual(bookingCollection);
                });
            });
        });
        afterEach(() => {
            httpMock.verify();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FraGlsc2luZ2gvRGVza3RvcC9Qcm9qZWN0cy93ZWRkaW5nL3NyYy9tYWluL3dlYmFwcC9hcHAvZW50aXRpZXMvYm9va2luZy9zZXJ2aWNlL2Jvb2tpbmcuc2VydmljZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsbURBQWdEO0FBQ2hELDBEQUE4RjtBQUM5RiwrQkFBK0I7QUFFL0IsZ0VBQThEO0FBQzlELHFFQUE0RDtBQUM1RCxvREFBcUQ7QUFFckQsdURBQW1EO0FBRW5ELFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO0lBQzdCLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsSUFBSSxPQUF1QixDQUFDO1FBQzVCLElBQUksUUFBK0IsQ0FBQztRQUNwQyxJQUFJLFdBQXFCLENBQUM7UUFDMUIsSUFBSSxjQUFzRCxDQUFDO1FBQzNELElBQUksV0FBd0IsQ0FBQztRQUU3QixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsaUJBQU8sQ0FBQyxzQkFBc0IsQ0FBQztnQkFDN0IsT0FBTyxFQUFFLENBQUMsaUNBQXVCLENBQUM7YUFDbkMsQ0FBQyxDQUFDO1lBQ0gsY0FBYyxHQUFHLElBQUksQ0FBQztZQUN0QixPQUFPLEdBQUcsaUJBQU8sQ0FBQyxNQUFNLENBQUMsZ0NBQWMsQ0FBQyxDQUFDO1lBQ3pDLFFBQVEsR0FBRyxpQkFBTyxDQUFDLE1BQU0sQ0FBQywrQkFBcUIsQ0FBQyxDQUFDO1lBQ2pELFdBQVcsR0FBRyxLQUFLLEVBQUUsQ0FBQztZQUV0QixXQUFXLEdBQUc7Z0JBQ1osRUFBRSxFQUFFLENBQUM7Z0JBQ0wsU0FBUyxFQUFFLFdBQVc7Z0JBQ3RCLEtBQUssRUFBRSxTQUFTO2dCQUNoQixJQUFJLEVBQUUsaUJBQUksQ0FBQyxNQUFNO2dCQUNqQixXQUFXLEVBQUUsV0FBVztnQkFDeEIsYUFBYSxFQUFFLFNBQVM7Z0JBQ3hCLE9BQU8sRUFBRSxTQUFTO2dCQUNsQixRQUFRLEVBQUUsU0FBUztnQkFDbkIsTUFBTSxFQUFFLFNBQVM7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QU0sRUFBRSxDQUFDO1FBQ3BCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYWtoaWxzaW5naC9EZXNrdG9wL1Byb2plY3RzL3dlZGRpbmcvc3JjL21haW4vd2ViYXBwL2FwcC9lbnRpdGllcy9ib29raW5nL3NlcnZpY2UvYm9va2luZy5zZXJ2aWNlLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdEJlZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvdGVzdGluZyc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50VGVzdGluZ01vZHVsZSwgSHR0cFRlc3RpbmdDb250cm9sbGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAvdGVzdGluZyc7XG5pbXBvcnQgKiBhcyBkYXlqcyBmcm9tICdkYXlqcyc7XG5cbmltcG9ydCB7IERBVEVfVElNRV9GT1JNQVQgfSBmcm9tICdhcHAvY29uZmlnL2lucHV0LmNvbnN0YW50cyc7XG5pbXBvcnQgeyBQbGFuIH0gZnJvbSAnYXBwL2VudGl0aWVzL2VudW1lcmF0aW9ucy9wbGFuLm1vZGVsJztcbmltcG9ydCB7IElCb29raW5nLCBCb29raW5nIH0gZnJvbSAnLi4vYm9va2luZy5tb2RlbCc7XG5cbmltcG9ydCB7IEJvb2tpbmdTZXJ2aWNlIH0gZnJvbSAnLi9ib29raW5nLnNlcnZpY2UnO1xuXG5kZXNjcmliZSgnU2VydmljZSBUZXN0cycsICgpID0+IHtcbiAgZGVzY3JpYmUoJ0Jvb2tpbmcgU2VydmljZScsICgpID0+IHtcbiAgICBsZXQgc2VydmljZTogQm9va2luZ1NlcnZpY2U7XG4gICAgbGV0IGh0dHBNb2NrOiBIdHRwVGVzdGluZ0NvbnRyb2xsZXI7XG4gICAgbGV0IGVsZW1EZWZhdWx0OiBJQm9va2luZztcbiAgICBsZXQgZXhwZWN0ZWRSZXN1bHQ6IElCb29raW5nIHwgSUJvb2tpbmdbXSB8IGJvb2xlYW4gfCBudWxsO1xuICAgIGxldCBjdXJyZW50RGF0ZTogZGF5anMuRGF5anM7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIFRlc3RCZWQuY29uZmlndXJlVGVzdGluZ01vZHVsZSh7XG4gICAgICAgIGltcG9ydHM6IFtIdHRwQ2xpZW50VGVzdGluZ01vZHVsZV0sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdGVkUmVzdWx0ID0gbnVsbDtcbiAgICAgIHNlcnZpY2UgPSBUZXN0QmVkLmluamVjdChCb29raW5nU2VydmljZSk7XG4gICAgICBodHRwTW9jayA9IFRlc3RCZWQuaW5qZWN0KEh0dHBUZXN0aW5nQ29udHJvbGxlcik7XG4gICAgICBjdXJyZW50RGF0ZSA9IGRheWpzKCk7XG5cbiAgICAgIGVsZW1EZWZhdWx0ID0ge1xuICAgICAgICBpZDogMCxcbiAgICAgICAgZXZlbnREYXRlOiBjdXJyZW50RGF0ZSxcbiAgICAgICAgdmVudWU6ICdBQUFBQUFBJyxcbiAgICAgICAgcGxhbjogUGxhbi5CUk9OWkUsXG4gICAgICAgIGNyZWF0ZWREYXRlOiBjdXJyZW50RGF0ZSxcbiAgICAgICAgY29udGFjdE51bWJlcjogJ0FBQUFBQUEnLFxuICAgICAgICBlbWFpbElkOiAnQUFBQUFBQScsXG4gICAgICAgIHVzZXJOYW1lOiAnQUFBQUFBQScsXG4gICAgICAgIHVzZXJJZDogJ0FBQUFBQUEnLFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdTZXJ2aWNlIG1ldGhvZHMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGZpbmQgYW4gZWxlbWVudCcsICgpID0+IHtcbiAgICAgICAgY29uc3QgcmV0dXJuZWRGcm9tU2VydmljZSA9IE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAge1xuICAgICAgICAgICAgZXZlbnREYXRlOiBjdXJyZW50RGF0ZS5mb3JtYXQoREFURV9USU1FX0ZPUk1BVCksXG4gICAgICAgICAgICBjcmVhdGVkRGF0ZTogY3VycmVudERhdGUuZm9ybWF0KERBVEVfVElNRV9GT1JNQVQpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZWxlbURlZmF1bHRcbiAgICAgICAgKTtcblxuICAgICAgICBzZXJ2aWNlLmZpbmQoMTIzKS5zdWJzY3JpYmUocmVzcCA9PiAoZXhwZWN0ZWRSZXN1bHQgPSByZXNwLmJvZHkpKTtcblxuICAgICAgICBjb25zdCByZXEgPSBodHRwTW9jay5leHBlY3RPbmUoeyBtZXRob2Q6ICdHRVQnIH0pO1xuICAgICAgICByZXEuZmx1c2gocmV0dXJuZWRGcm9tU2VydmljZSk7XG4gICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9NYXRjaE9iamVjdChlbGVtRGVmYXVsdCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBCb29raW5nJywgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXR1cm5lZEZyb21TZXJ2aWNlID0gT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogMCxcbiAgICAgICAgICAgIGV2ZW50RGF0ZTogY3VycmVudERhdGUuZm9ybWF0KERBVEVfVElNRV9GT1JNQVQpLFxuICAgICAgICAgICAgY3JlYXRlZERhdGU6IGN1cnJlbnREYXRlLmZvcm1hdChEQVRFX1RJTUVfRk9STUFUKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVsZW1EZWZhdWx0XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGV2ZW50RGF0ZTogY3VycmVudERhdGUsXG4gICAgICAgICAgICBjcmVhdGVkRGF0ZTogY3VycmVudERhdGUsXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXR1cm5lZEZyb21TZXJ2aWNlXG4gICAgICAgICk7XG5cbiAgICAgICAgc2VydmljZS5jcmVhdGUobmV3IEJvb2tpbmcoKSkuc3Vic2NyaWJlKHJlc3AgPT4gKGV4cGVjdGVkUmVzdWx0ID0gcmVzcC5ib2R5KSk7XG5cbiAgICAgICAgY29uc3QgcmVxID0gaHR0cE1vY2suZXhwZWN0T25lKHsgbWV0aG9kOiAnUE9TVCcgfSk7XG4gICAgICAgIHJlcS5mbHVzaChyZXR1cm5lZEZyb21TZXJ2aWNlKTtcbiAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b01hdGNoT2JqZWN0KGV4cGVjdGVkKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHVwZGF0ZSBhIEJvb2tpbmcnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJldHVybmVkRnJvbVNlcnZpY2UgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgICAgZXZlbnREYXRlOiBjdXJyZW50RGF0ZS5mb3JtYXQoREFURV9USU1FX0ZPUk1BVCksXG4gICAgICAgICAgICB2ZW51ZTogJ0JCQkJCQicsXG4gICAgICAgICAgICBwbGFuOiAnQkJCQkJCJyxcbiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiBjdXJyZW50RGF0ZS5mb3JtYXQoREFURV9USU1FX0ZPUk1BVCksXG4gICAgICAgICAgICBjb250YWN0TnVtYmVyOiAnQkJCQkJCJyxcbiAgICAgICAgICAgIGVtYWlsSWQ6ICdCQkJCQkInLFxuICAgICAgICAgICAgdXNlck5hbWU6ICdCQkJCQkInLFxuICAgICAgICAgICAgdXNlcklkOiAnQkJCQkJCJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVsZW1EZWZhdWx0XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGV2ZW50RGF0ZTogY3VycmVudERhdGUsXG4gICAgICAgICAgICBjcmVhdGVkRGF0ZTogY3VycmVudERhdGUsXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXR1cm5lZEZyb21TZXJ2aWNlXG4gICAgICAgICk7XG5cbiAgICAgICAgc2VydmljZS51cGRhdGUoZXhwZWN0ZWQpLnN1YnNjcmliZShyZXNwID0+IChleHBlY3RlZFJlc3VsdCA9IHJlc3AuYm9keSkpO1xuXG4gICAgICAgIGNvbnN0IHJlcSA9IGh0dHBNb2NrLmV4cGVjdE9uZSh7IG1ldGhvZDogJ1BVVCcgfSk7XG4gICAgICAgIHJlcS5mbHVzaChyZXR1cm5lZEZyb21TZXJ2aWNlKTtcbiAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b01hdGNoT2JqZWN0KGV4cGVjdGVkKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHBhcnRpYWwgdXBkYXRlIGEgQm9va2luZycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcGF0Y2hPYmplY3QgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvbnRhY3ROdW1iZXI6ICdCQkJCQkInLFxuICAgICAgICAgICAgdXNlcklkOiAnQkJCQkJCJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG5ldyBCb29raW5nKClcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCByZXR1cm5lZEZyb21TZXJ2aWNlID0gT2JqZWN0LmFzc2lnbihwYXRjaE9iamVjdCwgZWxlbURlZmF1bHQpO1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0gT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBldmVudERhdGU6IGN1cnJlbnREYXRlLFxuICAgICAgICAgICAgY3JlYXRlZERhdGU6IGN1cnJlbnREYXRlLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmV0dXJuZWRGcm9tU2VydmljZVxuICAgICAgICApO1xuXG4gICAgICAgIHNlcnZpY2UucGFydGlhbFVwZGF0ZShwYXRjaE9iamVjdCkuc3Vic2NyaWJlKHJlc3AgPT4gKGV4cGVjdGVkUmVzdWx0ID0gcmVzcC5ib2R5KSk7XG5cbiAgICAgICAgY29uc3QgcmVxID0gaHR0cE1vY2suZXhwZWN0T25lKHsgbWV0aG9kOiAnUEFUQ0gnIH0pO1xuICAgICAgICByZXEuZmx1c2gocmV0dXJuZWRGcm9tU2VydmljZSk7XG4gICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9NYXRjaE9iamVjdChleHBlY3RlZCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gYSBsaXN0IG9mIEJvb2tpbmcnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJldHVybmVkRnJvbVNlcnZpY2UgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgICAgZXZlbnREYXRlOiBjdXJyZW50RGF0ZS5mb3JtYXQoREFURV9USU1FX0ZPUk1BVCksXG4gICAgICAgICAgICB2ZW51ZTogJ0JCQkJCQicsXG4gICAgICAgICAgICBwbGFuOiAnQkJCQkJCJyxcbiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiBjdXJyZW50RGF0ZS5mb3JtYXQoREFURV9USU1FX0ZPUk1BVCksXG4gICAgICAgICAgICBjb250YWN0TnVtYmVyOiAnQkJCQkJCJyxcbiAgICAgICAgICAgIGVtYWlsSWQ6ICdCQkJCQkInLFxuICAgICAgICAgICAgdXNlck5hbWU6ICdCQkJCQkInLFxuICAgICAgICAgICAgdXNlcklkOiAnQkJCQkJCJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVsZW1EZWZhdWx0XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGV2ZW50RGF0ZTogY3VycmVudERhdGUsXG4gICAgICAgICAgICBjcmVhdGVkRGF0ZTogY3VycmVudERhdGUsXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXR1cm5lZEZyb21TZXJ2aWNlXG4gICAgICAgICk7XG5cbiAgICAgICAgc2VydmljZS5xdWVyeSgpLnN1YnNjcmliZShyZXNwID0+IChleHBlY3RlZFJlc3VsdCA9IHJlc3AuYm9keSkpO1xuXG4gICAgICAgIGNvbnN0IHJlcSA9IGh0dHBNb2NrLmV4cGVjdE9uZSh7IG1ldGhvZDogJ0dFVCcgfSk7XG4gICAgICAgIHJlcS5mbHVzaChbcmV0dXJuZWRGcm9tU2VydmljZV0pO1xuICAgICAgICBodHRwTW9jay52ZXJpZnkoKTtcbiAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0NvbnRhaW5FcXVhbChleHBlY3RlZCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBkZWxldGUgYSBCb29raW5nJywgKCkgPT4ge1xuICAgICAgICBzZXJ2aWNlLmRlbGV0ZSgxMjMpLnN1YnNjcmliZShyZXNwID0+IChleHBlY3RlZFJlc3VsdCA9IHJlc3Aub2spKTtcblxuICAgICAgICBjb25zdCByZXEgPSBodHRwTW9jay5leHBlY3RPbmUoeyBtZXRob2Q6ICdERUxFVEUnIH0pO1xuICAgICAgICByZXEuZmx1c2goeyBzdGF0dXM6IDIwMCB9KTtcbiAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KTtcbiAgICAgIH0pO1xuXG4gICAgICBkZXNjcmliZSgnYWRkQm9va2luZ1RvQ29sbGVjdGlvbklmTWlzc2luZycsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCBhZGQgYSBCb29raW5nIHRvIGFuIGVtcHR5IGFycmF5JywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGJvb2tpbmc6IElCb29raW5nID0geyBpZDogMTIzIH07XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBzZXJ2aWNlLmFkZEJvb2tpbmdUb0NvbGxlY3Rpb25JZk1pc3NpbmcoW10sIGJvb2tpbmcpO1xuICAgICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9Db250YWluKGJvb2tpbmcpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIG5vdCBhZGQgYSBCb29raW5nIHRvIGFuIGFycmF5IHRoYXQgY29udGFpbnMgaXQnLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgYm9va2luZzogSUJvb2tpbmcgPSB7IGlkOiAxMjMgfTtcbiAgICAgICAgICBjb25zdCBib29raW5nQ29sbGVjdGlvbjogSUJvb2tpbmdbXSA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgLi4uYm9va2luZyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7IGlkOiA0NTYgfSxcbiAgICAgICAgICBdO1xuICAgICAgICAgIGV4cGVjdGVkUmVzdWx0ID0gc2VydmljZS5hZGRCb29raW5nVG9Db2xsZWN0aW9uSWZNaXNzaW5nKGJvb2tpbmdDb2xsZWN0aW9uLCBib29raW5nKTtcbiAgICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgYWRkIGEgQm9va2luZyB0byBhbiBhcnJheSB0aGF0IGRvZXNuJ3QgY29udGFpbiBpdFwiLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgYm9va2luZzogSUJvb2tpbmcgPSB7IGlkOiAxMjMgfTtcbiAgICAgICAgICBjb25zdCBib29raW5nQ29sbGVjdGlvbjogSUJvb2tpbmdbXSA9IFt7IGlkOiA0NTYgfV07XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBzZXJ2aWNlLmFkZEJvb2tpbmdUb0NvbGxlY3Rpb25JZk1pc3NpbmcoYm9va2luZ0NvbGxlY3Rpb24sIGJvb2tpbmcpO1xuICAgICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9Db250YWluKGJvb2tpbmcpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGFkZCBvbmx5IHVuaXF1ZSBCb29raW5nIHRvIGFuIGFycmF5JywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGJvb2tpbmdBcnJheTogSUJvb2tpbmdbXSA9IFt7IGlkOiAxMjMgfSwgeyBpZDogNDU2IH0sIHsgaWQ6IDUyOTczIH1dO1xuICAgICAgICAgIGNvbnN0IGJvb2tpbmdDb2xsZWN0aW9uOiBJQm9va2luZ1tdID0gW3sgaWQ6IDEyMyB9XTtcbiAgICAgICAgICBleHBlY3RlZFJlc3VsdCA9IHNlcnZpY2UuYWRkQm9va2luZ1RvQ29sbGVjdGlvbklmTWlzc2luZyhib29raW5nQ29sbGVjdGlvbiwgLi4uYm9va2luZ0FycmF5KTtcbiAgICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgdmFyYXJncycsICgpID0+IHtcbiAgICAgICAgICBjb25zdCBib29raW5nOiBJQm9va2luZyA9IHsgaWQ6IDEyMyB9O1xuICAgICAgICAgIGNvbnN0IGJvb2tpbmcyOiBJQm9va2luZyA9IHsgaWQ6IDQ1NiB9O1xuICAgICAgICAgIGV4cGVjdGVkUmVzdWx0ID0gc2VydmljZS5hZGRCb29raW5nVG9Db2xsZWN0aW9uSWZNaXNzaW5nKFtdLCBib29raW5nLCBib29raW5nMik7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0hhdmVMZW5ndGgoMik7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0NvbnRhaW4oYm9va2luZyk7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0NvbnRhaW4oYm9va2luZzIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGFjY2VwdCBudWxsIGFuZCB1bmRlZmluZWQgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGJvb2tpbmc6IElCb29raW5nID0geyBpZDogMTIzIH07XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBzZXJ2aWNlLmFkZEJvb2tpbmdUb0NvbGxlY3Rpb25JZk1pc3NpbmcoW10sIG51bGwsIGJvb2tpbmcsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0NvbnRhaW4oYm9va2luZyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGluaXRpYWwgYXJyYXkgaWYgbm8gQm9va2luZyBpcyBhZGRlZCcsICgpID0+IHtcbiAgICAgICAgICBjb25zdCBib29raW5nQ29sbGVjdGlvbjogSUJvb2tpbmdbXSA9IFt7IGlkOiAxMjMgfV07XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBzZXJ2aWNlLmFkZEJvb2tpbmdUb0NvbGxlY3Rpb25JZk1pc3NpbmcoYm9va2luZ0NvbGxlY3Rpb24sIHVuZGVmaW5lZCwgbnVsbCk7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0VxdWFsKGJvb2tpbmdDb2xsZWN0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICBodHRwTW9jay52ZXJpZnkoKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==