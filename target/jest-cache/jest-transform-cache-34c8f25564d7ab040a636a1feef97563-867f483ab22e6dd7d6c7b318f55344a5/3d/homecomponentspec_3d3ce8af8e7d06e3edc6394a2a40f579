e5b8781d177a45ee87a8c1347c7ecc47
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
jest.mock('app/core/auth/account.service');
jest.mock('@angular/router');
const testing_1 = require("@angular/core/testing");
const router_1 = require("@angular/router");
const rxjs_1 = require("rxjs");
const account_service_1 = require("app/core/auth/account.service");
const home_component_1 = require("./home.component");
describe('Component Tests', () => {
    describe('Home Component', () => {
        let comp;
        let fixture;
        let mockAccountService;
        let mockRouter;
        const account = {
            activated: true,
            authorities: [],
            email: '',
            firstName: null,
            langKey: '',
            lastName: null,
            login: 'login',
            imageUrl: null,
        };
        beforeEach(testing_1.waitForAsync(() => {
            testing_1.TestBed.configureTestingModule({
                declarations: [home_component_1.HomeComponent],
                providers: [account_service_1.AccountService, router_1.Router],
            })
                .overrideTemplate(home_component_1.HomeComponent, '')
                .compileComponents();
        }));
        beforeEach(() => {
            fixture = testing_1.TestBed.createComponent(home_component_1.HomeComponent);
            comp = fixture.componentInstance;
            mockAccountService = testing_1.TestBed.inject(account_service_1.AccountService);
            mockAccountService.identity = jest.fn(() => rxjs_1.of(null));
            mockAccountService.getAuthenticationState = jest.fn(() => rxjs_1.of(null));
            mockRouter = testing_1.TestBed.inject(router_1.Router);
        });
        describe('ngOnInit', () => {
            it('Should synchronize account variable with current account', () => {
                // GIVEN
                const authenticationState = new rxjs_1.Subject();
                mockAccountService.getAuthenticationState = jest.fn(() => authenticationState.asObservable());
                // WHEN
                comp.ngOnInit();
                // THEN
                expect(comp.account).toBeNull();
                // WHEN
                authenticationState.next(account);
                // THEN
                expect(comp.account).toEqual(account);
                // WHEN
                authenticationState.next(null);
                // THEN
                expect(comp.account).toBeNull();
            });
        });
        describe('login', () => {
            it('Should navigate to /login on login', () => {
                // WHEN
                comp.login();
                // THEN
                expect(mockRouter.navigate).toHaveBeenCalledWith(['/login']);
            });
        });
        describe('ngOnDestroy', () => {
            it('Should destroy authentication state subscription on component destroy', () => {
                // GIVEN
                const authenticationState = new rxjs_1.Subject();
                mockAccountService.getAuthenticationState = jest.fn(() => authenticationState.asObservable());
                // WHEN
                comp.ngOnInit();
                // THEN
                expect(comp.account).toBeNull();
                // WHEN
                authenticationState.next(account);
                // THEN
                expect(comp.account).toEqual(account);
                // WHEN
                comp.ngOnDestroy();
                authenticationState.next(null);
                // THEN
                expect(comp.account).toEqual(account);
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FraGlsc2luZ2gvRGVza3RvcC9Qcm9qZWN0cy93ZWRkaW5nL3NyYy9tYWluL3dlYmFwcC9hcHAvaG9tZS9ob21lLmNvbXBvbmVudC5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSSxDQUFDLElBQUksQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO0FBQzNDLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztBQUU3QixtREFBZ0Y7QUFDaEYsNENBQXlDO0FBQ3pDLCtCQUFtQztBQUVuQyxtRUFBK0Q7QUFHL0QscURBQWlEO0FBRWpELFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM5QixJQUFJLElBQW1CLENBQUM7UUFDeEIsSUFBSSxPQUF3QyxDQUFDO1FBQzdDLElBQUksa0JBQWtDLENBQUM7UUFDdkMsSUFBSSxVQUFrQixDQUFDO1FBQ3ZCLE1BQU0sT0FBTyxHQUFZO1lBQ3ZCLFNBQVMsRUFBRSxJQUFJO1lBQ2YsV0FBVyxFQUFFLEVBQUU7WUFDZixLQUFLLEVBQUUsRUFBRTtZQUNULFNBQVMsRUFBRSxJQUFJO1lBQ2YsT0FBTyxFQUFFLEVBQUU7WUFDWCxRQUFRLEVBQUUsSUFBSTtZQUNkLEtBQUssRUFBRSxPQUFPO1lBQ2QsUUFBUSxFQUFFLElBQUk7U0FDZixDQUFDO1FBRUYsVUFBVSxDQUNSLHNCQUFZLENBQUMsR0FBRyxFQUFFO1lBQ2hCLGlCQUFPLENBQUMsc0JBQXNCLENBQUM7Z0JBQzdCLFlBQVksRUFBRSxDQUFDLDhCQUFhLENBQUM7Z0JBQzdCLFNBQVMsRUFBRSxDQUFDLGdDQUFjLEVBQUUsZUFBTSxDQUFDO2FBQ3BDLENBQUM7aUJBQ0MsZ0JBQWdCLENBQUMsOEJBQWEsRUFBRSxFQUFFLENBQUM7aUJBQ25DLGlCQUFpQixFQUFFLENBQUM7UUFDekIsQ0FBQyxDQUFDLENBQ0gsQ0FBQztRQUVGLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDZCxPQUFPLEdB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bUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBRS9CLE9BQU87Z0JBQ1AsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDeEMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2FraGlsc2luZ2gvRGVza3RvcC9Qcm9qZWN0cy93ZWRkaW5nL3NyYy9tYWluL3dlYmFwcC9hcHAvaG9tZS9ob21lLmNvbXBvbmVudC5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImplc3QubW9jaygnYXBwL2NvcmUvYXV0aC9hY2NvdW50LnNlcnZpY2UnKTtcbmplc3QubW9jaygnQGFuZ3VsYXIvcm91dGVyJyk7XG5cbmltcG9ydCB7IENvbXBvbmVudEZpeHR1cmUsIFRlc3RCZWQsIHdhaXRGb3JBc3luYyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvdGVzdGluZyc7XG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgb2YsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgQWNjb3VudFNlcnZpY2UgfSBmcm9tICdhcHAvY29yZS9hdXRoL2FjY291bnQuc2VydmljZSc7XG5pbXBvcnQgeyBBY2NvdW50IH0gZnJvbSAnYXBwL2NvcmUvYXV0aC9hY2NvdW50Lm1vZGVsJztcblxuaW1wb3J0IHsgSG9tZUNvbXBvbmVudCB9IGZyb20gJy4vaG9tZS5jb21wb25lbnQnO1xuXG5kZXNjcmliZSgnQ29tcG9uZW50IFRlc3RzJywgKCkgPT4ge1xuICBkZXNjcmliZSgnSG9tZSBDb21wb25lbnQnLCAoKSA9PiB7XG4gICAgbGV0IGNvbXA6IEhvbWVDb21wb25lbnQ7XG4gICAgbGV0IGZpeHR1cmU6IENvbXBvbmVudEZpeHR1cmU8SG9tZUNvbXBvbmVudD47XG4gICAgbGV0IG1vY2tBY2NvdW50U2VydmljZTogQWNjb3VudFNlcnZpY2U7XG4gICAgbGV0IG1vY2tSb3V0ZXI6IFJvdXRlcjtcbiAgICBjb25zdCBhY2NvdW50OiBBY2NvdW50ID0ge1xuICAgICAgYWN0aXZhdGVkOiB0cnVlLFxuICAgICAgYXV0aG9yaXRpZXM6IFtdLFxuICAgICAgZW1haWw6ICcnLFxuICAgICAgZmlyc3ROYW1lOiBudWxsLFxuICAgICAgbGFuZ0tleTogJycsXG4gICAgICBsYXN0TmFtZTogbnVsbCxcbiAgICAgIGxvZ2luOiAnbG9naW4nLFxuICAgICAgaW1hZ2VVcmw6IG51bGwsXG4gICAgfTtcblxuICAgIGJlZm9yZUVhY2goXG4gICAgICB3YWl0Rm9yQXN5bmMoKCkgPT4ge1xuICAgICAgICBUZXN0QmVkLmNvbmZpZ3VyZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgICAgIGRlY2xhcmF0aW9uczogW0hvbWVDb21wb25lbnRdLFxuICAgICAgICAgIHByb3ZpZGVyczogW0FjY291bnRTZXJ2aWNlLCBSb3V0ZXJdLFxuICAgICAgICB9KVxuICAgICAgICAgIC5vdmVycmlkZVRlbXBsYXRlKEhvbWVDb21wb25lbnQsICcnKVxuICAgICAgICAgIC5jb21waWxlQ29tcG9uZW50cygpO1xuICAgICAgfSlcbiAgICApO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBmaXh0dXJlID0gVGVzdEJlZC5jcmVhdGVDb21wb25lbnQoSG9tZUNvbXBvbmVudCk7XG4gICAgICBjb21wID0gZml4dHVyZS5jb21wb25lbnRJbnN0YW5jZTtcbiAgICAgIG1vY2tBY2NvdW50U2VydmljZSA9IFRlc3RCZWQuaW5qZWN0KEFjY291bnRTZXJ2aWNlKTtcbiAgICAgIG1vY2tBY2NvdW50U2VydmljZS5pZGVudGl0eSA9IGplc3QuZm4oKCkgPT4gb2YobnVsbCkpO1xuICAgICAgbW9ja0FjY291bnRTZXJ2aWNlLmdldEF1dGhlbnRpY2F0aW9uU3RhdGUgPSBqZXN0LmZuKCgpID0+IG9mKG51bGwpKTtcbiAgICAgIG1vY2tSb3V0ZXIgPSBUZXN0QmVkLmluamVjdChSb3V0ZXIpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ25nT25Jbml0JywgKCkgPT4ge1xuICAgICAgaXQoJ1Nob3VsZCBzeW5jaHJvbml6ZSBhY2NvdW50IHZhcmlhYmxlIHdpdGggY3VycmVudCBhY2NvdW50JywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBhdXRoZW50aWNhdGlvblN0YXRlID0gbmV3IFN1YmplY3Q8QWNjb3VudCB8IG51bGw+KCk7XG4gICAgICAgIG1vY2tBY2NvdW50U2VydmljZS5nZXRBdXRoZW50aWNhdGlvblN0YXRlID0gamVzdC5mbigoKSA9PiBhdXRoZW50aWNhdGlvblN0YXRlLmFzT2JzZXJ2YWJsZSgpKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbXAubmdPbkluaXQoKTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIGV4cGVjdChjb21wLmFjY291bnQpLnRvQmVOdWxsKCk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBhdXRoZW50aWNhdGlvblN0YXRlLm5leHQoYWNjb3VudCk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBleHBlY3QoY29tcC5hY2NvdW50KS50b0VxdWFsKGFjY291bnQpO1xuXG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgYXV0aGVudGljYXRpb25TdGF0ZS5uZXh0KG51bGwpO1xuXG4gICAgICAgIC8vIFRIRU5cbiAgICAgICAgZXhwZWN0KGNvbXAuYWNjb3VudCkudG9CZU51bGwoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2xvZ2luJywgKCkgPT4ge1xuICAgICAgaXQoJ1Nob3VsZCBuYXZpZ2F0ZSB0byAvbG9naW4gb24gbG9naW4nLCAoKSA9PiB7XG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgY29tcC5sb2dpbigpO1xuXG4gICAgICAgIC8vIFRIRU5cbiAgICAgICAgZXhwZWN0KG1vY2tSb3V0ZXIubmF2aWdhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFsnL2xvZ2luJ10pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnbmdPbkRlc3Ryb3knLCAoKSA9PiB7XG4gICAgICBpdCgnU2hvdWxkIGRlc3Ryb3kgYXV0aGVudGljYXRpb24gc3RhdGUgc3Vic2NyaXB0aW9uIG9uIGNvbXBvbmVudCBkZXN0cm95JywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBhdXRoZW50aWNhdGlvblN0YXRlID0gbmV3IFN1YmplY3Q8QWNjb3VudCB8IG51bGw+KCk7XG4gICAgICAgIG1vY2tBY2NvdW50U2VydmljZS5nZXRBdXRoZW50aWNhdGlvblN0YXRlID0gamVzdC5mbigoKSA9PiBhdXRoZW50aWNhdGlvblN0YXRlLmFzT2JzZXJ2YWJsZSgpKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbXAubmdPbkluaXQoKTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIGV4cGVjdChjb21wLmFjY291bnQpLnRvQmVOdWxsKCk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBhdXRoZW50aWNhdGlvblN0YXRlLm5leHQoYWNjb3VudCk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBleHBlY3QoY29tcC5hY2NvdW50KS50b0VxdWFsKGFjY291bnQpO1xuXG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgY29tcC5uZ09uRGVzdHJveSgpO1xuICAgICAgICBhdXRoZW50aWNhdGlvblN0YXRlLm5leHQobnVsbCk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBleHBlY3QoY29tcC5hY2NvdW50KS50b0VxdWFsKGFjY291bnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=