5e5dd2556b9971d4c47243bb75e8ec5b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@angular/core/testing");
const testing_2 = require("@angular/common/http/testing");
const user_model_1 = require("./user.model");
const user_service_1 = require("./user.service");
describe('Service Tests', () => {
    describe('User Service', () => {
        let service;
        let httpMock;
        let expectedResult;
        beforeEach(() => {
            testing_1.TestBed.configureTestingModule({
                imports: [testing_2.HttpClientTestingModule],
            });
            expectedResult = null;
            service = testing_1.TestBed.inject(user_service_1.UserService);
            httpMock = testing_1.TestBed.inject(testing_2.HttpTestingController);
        });
        afterEach(() => {
            httpMock.verify();
        });
        describe('Service methods', () => {
            it('should return Users', () => {
                service.query().subscribe(received => {
                    expectedResult = received.body;
                });
                const req = httpMock.expectOne({ method: 'GET' });
                req.flush([new user_model_1.User(123, 'user')]);
                expect(expectedResult).toEqual([{ id: 123, login: 'user' }]);
            });
            it('should propagate not found response', () => {
                service.query().subscribe({
                    error: (error) => (expectedResult = error.status),
                });
                const req = httpMock.expectOne({ method: 'GET' });
                req.flush('Internal Server Error', {
                    status: 500,
                    statusText: 'Inernal Server Error',
                });
                expect(expectedResult).toEqual(500);
            });
            describe('addUserToCollectionIfMissing', () => {
                it('should add a User to an empty array', () => {
                    const user = { id: 123 };
                    expectedResult = service.addUserToCollectionIfMissing([], user);
                    expect(expectedResult).toHaveLength(1);
                    expect(expectedResult).toContain(user);
                });
                it('should not add a User to an array that contains it', () => {
                    const user = { id: 123 };
                    const userCollection = [
                        Object.assign({}, user),
                        { id: 456 },
                    ];
                    expectedResult = service.addUserToCollectionIfMissing(userCollection, user);
                    expect(expectedResult).toHaveLength(2);
                });
                it("should add a User to an array that doesn't contain it", () => {
                    const user = { id: 123 };
                    const userCollection = [{ id: 456 }];
                    expectedResult = service.addUserToCollectionIfMissing(userCollection, user);
                    expect(expectedResult).toHaveLength(2);
                    expect(expectedResult).toContain(user);
                });
                it('should add only unique User to an array', () => {
                    const userArray = [{ id: 123 }, { id: 456 }, { id: 27699 }];
                    const userCollection = [{ id: 456 }];
                    expectedResult = service.addUserToCollectionIfMissing(userCollection, ...userArray);
                    expect(expectedResult).toHaveLength(3);
                });
                it('should accept varargs', () => {
                    const user = { id: 123 };
                    const user2 = { id: 456 };
                    expectedResult = service.addUserToCollectionIfMissing([], user, user2);
                    expect(expectedResult).toHaveLength(2);
                    expect(expectedResult).toContain(user);
                    expect(expectedResult).toContain(user2);
                });
                it('should accept null and undefined values', () => {
                    const user = { id: 123 };
                    expectedResult = service.addUserToCollectionIfMissing([], null, user, undefined);
                    expect(expectedResult).toHaveLength(1);
                    expect(expectedResult).toContain(user);
                });
                it('should return initial array if no users is added', () => {
                    const userCollection = [{ id: 456 }];
                    expectedResult = service.addUserToCollectionIfMissing(userCollection, null, undefined);
                    expect(expectedResult).toEqual(userCollection);
                });
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FraGlsc2luZ2gvRGVza3RvcC9Qcm9qZWN0cy93ZWRkaW5nL3NyYy9tYWluL3dlYmFwcC9hcHAvZW50aXRpZXMvdXNlci91c2VyLnNlcnZpY2Uuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLG1EQUFnRDtBQUVoRCwwREFBOEY7QUFFOUYsNkNBQTJDO0FBRTNDLGlEQUE2QztBQUU3QyxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtJQUM3QixRQUFRLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRTtRQUM1QixJQUFJLE9BQW9CLENBQUM7UUFDekIsSUFBSSxRQUErQixDQUFDO1FBQ3BDLElBQUksY0FBeUQsQ0FBQztRQUU5RCxVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsaUJBQU8sQ0FBQyxzQkFBc0IsQ0FBQztnQkFDN0IsT0FBTyxFQUFFLENBQUMsaUNBQXVCLENBQUM7YUFDbkMsQ0FBQyxDQUFDO1lBQ0gsY0FBYyxHQUFHLElBQUksQ0FBQztZQUN0QixPQUFPLEdBQUcsaUJBQU8sQ0FBQyxNQUFNLENBQUMsMEJBQVcsQ0FBQyxDQUFDO1lBQ3RDLFFBQVEsR0FBRyxpQkFBTyxDQUFDLE1BQU0sQ0FBQywrQkFBcUIsQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO1FBRUgsU0FBUyxDQUFDLEdBQUcsRUFBRTtZQUNiLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNwQixDQUFDLENBQUMsQ0FBQztRQUVILFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7WUFDL0IsRUFBRSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtnQkFDN0IsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsRUFBRTtvQkFDbkMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUM7Z0JBQ2pDLENBQUMsQ0FBQyxDQUFDO2dCQUVILE1BQU0sR0FBRyxHQUFHLFFBQVEsQ0FBQyxTQUFTLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztnQkFDbEQsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksaUJBQUksQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNuQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDL0QsQ0FBQyxDQUFDLENBQUM7WUFFSCxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBRyxFQUFFO2dCQUM3QyxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUMsU0FBUyxDQUFDO29CQUN4QixLQUFLLEVBQUUsQ0FBQyxLQUF3QixFQUFFLEVBQUUsQ0FBQyxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO2lCQUNyRSxDQUFDLENBQUM7Z0JBRUgsTUFBTSxHQUFHLEdBQUcsUUFBUSxDQUFDLFNBQVMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO2dCQUNsRCxHQUFHLENBQUMsS0FBSyxDQUFDLHVCQUF1QixFQUFFO29CQUNqQyxNQUFNLEVBQUUsR0FBRztvQkFDWCxVQUFVLEVBQUUsc0JBQXNCO2lCQUNuQyxDQUFDLENBQUM7Z0JBQ0gsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUN0QyxDQUFDLENBQUMsQ0FBQztZQUVILFFBQVEsQ0FBQyw4QkFBOEIsRUFBRSxHQUFHLEVBQUU7Z0JBQzVDLEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxHQUFHLEVBQUU7b0JBQzdDLE1BQU0sSUFBSSxHQUFVLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDO29CQUNoQyxjQUFjLEdBQUcsT0FBTyxDQUFDLDRCQUE0QixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztvQkFDaEUsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdkMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDekMsQ0FBQyxDQUFDLENBQUM7Z0JBRUgsRUFBRSxDQUFDLG9EQUFvRCxFQUFFLEdBQUcsRUFBRTtvQkFDNUQsTUFBTSxJQUFJLEdBQVUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUM7b0JBQ2hDLE1BQU0sY0FBYyxHQUFZOzBDQUV6QixJQUFJO3dCQUVULEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRTtxQkFDWixDQUFDO29CQUNGLGNBQWMsR0FBRyxPQUFPLENBQUMsNEJBQTRCLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFDO29CQUM1RSxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN6QyxDQUFDLENBQUMsQ0FBQztnQkFFSCxFQUFFLENBQUMsdURBQXVELEVBQUUsR0FBRyxFQUFFO29CQUMvRCxNQUFNLElBQUksR0FBVSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQztvQkFDaEMsTUFBTSxjQUFjLEdBQVksQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO29CQUM5QyxjQUFjLEdBQUcsT0FBTyxDQUFDLDRCQUE0QixDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsQ0FBQztvQkFDNUUsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdkMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDekMsQ0FBQyxDQUFDLENBQUM7Z0JBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEdBQUcsRUFBRTtvQkFDakQsTUFBTSxTQUFTLEdBQVksQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO29CQUNyRSxNQUFNLGNBQWMsR0FBWSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7b0JBQzlDLGNBQWMsR0FBRyxPQUFPLENBQUMsNEJBQTRCLENBQUMsY0FBYyxFQUFFLEdBQUcsU0FBUyxDQUFDLENBQUM7b0JBQ3BGLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3pDLENBQUMsQ0FBQyxDQUFDO2dCQUVILEVBQUUsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7b0JBQy9CLE1BQU0sSUFBSSxHQUFVLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDO29CQUNoQyxNQUFNLEtBQUssR0FBVSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQztvQkFDakMsY0FBYyxHQUFHLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO29CQUN2RSxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUN2QyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO29CQUN2QyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMxQyxDQUFDLENBQUMsQ0FBQztnQkFFSCxFQUFFLENBQUMseUNBQXlDLEVBQUUsR0FBRyxFQUFFO29CQUNqRCxNQUFNLElBQUksR0FBVSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQztvQkFDaEMsY0FBYyxHQUFHLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztvQkFDakYsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdkMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDekMsQ0FBQyxDQUFDLENBQUM7Z0JBRUgsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEdBQUcsRUFBRTtvQkFDMUQsTUFBTSxjQUFjLEdBQVksQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO29CQUM5QyxjQUFjLEdBQUcsT0FBTyxDQUFDLDRCQUE0QixDQUFDLGNBQWMsRUFBRSxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7b0JBQ3ZGLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUM7Z0JBQ2pELENBQUMsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2FraGlsc2luZ2gvRGVza3RvcC9Qcm9qZWN0cy93ZWRkaW5nL3NyYy9tYWluL3dlYmFwcC9hcHAvZW50aXRpZXMvdXNlci91c2VyLnNlcnZpY2Uuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0QmVkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZS90ZXN0aW5nJztcbmltcG9ydCB7IEh0dHBFcnJvclJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgSHR0cENsaWVudFRlc3RpbmdNb2R1bGUsIEh0dHBUZXN0aW5nQ29udHJvbGxlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwL3Rlc3RpbmcnO1xuXG5pbXBvcnQgeyBVc2VyLCBJVXNlciB9IGZyb20gJy4vdXNlci5tb2RlbCc7XG5cbmltcG9ydCB7IFVzZXJTZXJ2aWNlIH0gZnJvbSAnLi91c2VyLnNlcnZpY2UnO1xuXG5kZXNjcmliZSgnU2VydmljZSBUZXN0cycsICgpID0+IHtcbiAgZGVzY3JpYmUoJ1VzZXIgU2VydmljZScsICgpID0+IHtcbiAgICBsZXQgc2VydmljZTogVXNlclNlcnZpY2U7XG4gICAgbGV0IGh0dHBNb2NrOiBIdHRwVGVzdGluZ0NvbnRyb2xsZXI7XG4gICAgbGV0IGV4cGVjdGVkUmVzdWx0OiBJVXNlciB8IElVc2VyW10gfCBib29sZWFuIHwgbnVtYmVyIHwgbnVsbDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgVGVzdEJlZC5jb25maWd1cmVUZXN0aW5nTW9kdWxlKHtcbiAgICAgICAgaW1wb3J0czogW0h0dHBDbGllbnRUZXN0aW5nTW9kdWxlXSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBudWxsO1xuICAgICAgc2VydmljZSA9IFRlc3RCZWQuaW5qZWN0KFVzZXJTZXJ2aWNlKTtcbiAgICAgIGh0dHBNb2NrID0gVGVzdEJlZC5pbmplY3QoSHR0cFRlc3RpbmdDb250cm9sbGVyKTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICBodHRwTW9jay52ZXJpZnkoKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdTZXJ2aWNlIG1ldGhvZHMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiBVc2VycycsICgpID0+IHtcbiAgICAgICAgc2VydmljZS5xdWVyeSgpLnN1YnNjcmliZShyZWNlaXZlZCA9PiB7XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSByZWNlaXZlZC5ib2R5O1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXEgPSBodHRwTW9jay5leHBlY3RPbmUoeyBtZXRob2Q6ICdHRVQnIH0pO1xuICAgICAgICByZXEuZmx1c2goW25ldyBVc2VyKDEyMywgJ3VzZXInKV0pO1xuICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvRXF1YWwoW3sgaWQ6IDEyMywgbG9naW46ICd1c2VyJyB9XSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBwcm9wYWdhdGUgbm90IGZvdW5kIHJlc3BvbnNlJywgKCkgPT4ge1xuICAgICAgICBzZXJ2aWNlLnF1ZXJ5KCkuc3Vic2NyaWJlKHtcbiAgICAgICAgICBlcnJvcjogKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4gKGV4cGVjdGVkUmVzdWx0ID0gZXJyb3Iuc3RhdHVzKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVxID0gaHR0cE1vY2suZXhwZWN0T25lKHsgbWV0aG9kOiAnR0VUJyB9KTtcbiAgICAgICAgcmVxLmZsdXNoKCdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InLCB7XG4gICAgICAgICAgc3RhdHVzOiA1MDAsXG4gICAgICAgICAgc3RhdHVzVGV4dDogJ0luZXJuYWwgU2VydmVyIEVycm9yJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9FcXVhbCg1MDApO1xuICAgICAgfSk7XG5cbiAgICAgIGRlc2NyaWJlKCdhZGRVc2VyVG9Db2xsZWN0aW9uSWZNaXNzaW5nJywgKCkgPT4ge1xuICAgICAgICBpdCgnc2hvdWxkIGFkZCBhIFVzZXIgdG8gYW4gZW1wdHkgYXJyYXknLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgdXNlcjogSVVzZXIgPSB7IGlkOiAxMjMgfTtcbiAgICAgICAgICBleHBlY3RlZFJlc3VsdCA9IHNlcnZpY2UuYWRkVXNlclRvQ29sbGVjdGlvbklmTWlzc2luZyhbXSwgdXNlcik7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0NvbnRhaW4odXNlcik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgbm90IGFkZCBhIFVzZXIgdG8gYW4gYXJyYXkgdGhhdCBjb250YWlucyBpdCcsICgpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyOiBJVXNlciA9IHsgaWQ6IDEyMyB9O1xuICAgICAgICAgIGNvbnN0IHVzZXJDb2xsZWN0aW9uOiBJVXNlcltdID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAuLi51c2VyLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHsgaWQ6IDQ1NiB9LFxuICAgICAgICAgIF07XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBzZXJ2aWNlLmFkZFVzZXJUb0NvbGxlY3Rpb25JZk1pc3NpbmcodXNlckNvbGxlY3Rpb24sIHVzZXIpO1xuICAgICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZCBhZGQgYSBVc2VyIHRvIGFuIGFycmF5IHRoYXQgZG9lc24ndCBjb250YWluIGl0XCIsICgpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyOiBJVXNlciA9IHsgaWQ6IDEyMyB9O1xuICAgICAgICAgIGNvbnN0IHVzZXJDb2xsZWN0aW9uOiBJVXNlcltdID0gW3sgaWQ6IDQ1NiB9XTtcbiAgICAgICAgICBleHBlY3RlZFJlc3VsdCA9IHNlcnZpY2UuYWRkVXNlclRvQ29sbGVjdGlvbklmTWlzc2luZyh1c2VyQ29sbGVjdGlvbiwgdXNlcik7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0hhdmVMZW5ndGgoMik7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0NvbnRhaW4odXNlcik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgYWRkIG9ubHkgdW5pcXVlIFVzZXIgdG8gYW4gYXJyYXknLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgdXNlckFycmF5OiBJVXNlcltdID0gW3sgaWQ6IDEyMyB9LCB7IGlkOiA0NTYgfSwgeyBpZDogMjc2OTkgfV07XG4gICAgICAgICAgY29uc3QgdXNlckNvbGxlY3Rpb246IElVc2VyW10gPSBbeyBpZDogNDU2IH1dO1xuICAgICAgICAgIGV4cGVjdGVkUmVzdWx0ID0gc2VydmljZS5hZGRVc2VyVG9Db2xsZWN0aW9uSWZNaXNzaW5nKHVzZXJDb2xsZWN0aW9uLCAuLi51c2VyQXJyYXkpO1xuICAgICAgICAgIGV4cGVjdChleHBlY3RlZFJlc3VsdCkudG9IYXZlTGVuZ3RoKDMpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGFjY2VwdCB2YXJhcmdzJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVzZXI6IElVc2VyID0geyBpZDogMTIzIH07XG4gICAgICAgICAgY29uc3QgdXNlcjI6IElVc2VyID0geyBpZDogNDU2IH07XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBzZXJ2aWNlLmFkZFVzZXJUb0NvbGxlY3Rpb25JZk1pc3NpbmcoW10sIHVzZXIsIHVzZXIyKTtcbiAgICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvQ29udGFpbih1c2VyKTtcbiAgICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvQ29udGFpbih1c2VyMik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgYWNjZXB0IG51bGwgYW5kIHVuZGVmaW5lZCB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgdXNlcjogSVVzZXIgPSB7IGlkOiAxMjMgfTtcbiAgICAgICAgICBleHBlY3RlZFJlc3VsdCA9IHNlcnZpY2UuYWRkVXNlclRvQ29sbGVjdGlvbklmTWlzc2luZyhbXSwgbnVsbCwgdXNlciwgdW5kZWZpbmVkKTtcbiAgICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgICAgICBleHBlY3QoZXhwZWN0ZWRSZXN1bHQpLnRvQ29udGFpbih1c2VyKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gaW5pdGlhbCBhcnJheSBpZiBubyB1c2VycyBpcyBhZGRlZCcsICgpID0+IHtcbiAgICAgICAgICBjb25zdCB1c2VyQ29sbGVjdGlvbjogSVVzZXJbXSA9IFt7IGlkOiA0NTYgfV07XG4gICAgICAgICAgZXhwZWN0ZWRSZXN1bHQgPSBzZXJ2aWNlLmFkZFVzZXJUb0NvbGxlY3Rpb25JZk1pc3NpbmcodXNlckNvbGxlY3Rpb24sIG51bGwsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgZXhwZWN0KGV4cGVjdGVkUmVzdWx0KS50b0VxdWFsKHVzZXJDb2xsZWN0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==